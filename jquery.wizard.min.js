(function(e){"use strict";var t={onInit:function(){},onPrev:function(){},onNext:function(){},onOther:function(){},onFinish:function(){},onStart:function(){},onBeforeStep:function(){},onStep:function(){},disableonfinish:true,fade:true,stepBar:{visible:true,type:"breadcrumb",buttonClass:"btn navbar-btn btn-default",objectType:"button",useAnchor:true,useDivider:false,divider:"",dividerText:"",dividerClass:"",numberOfVisible:2}};e.fn.wizard=function(n){if(typeof n==="undefined"){n={}}if(this.length===0)return this;var r={};var i={};var s={};var o={};if(this.length>1){r=this[0]}else{r=this}var u=function(){for(var o in t){if(t.hasOwnProperty(o)){if(r.attr("data-wizard-"+o.toLowerCase())){n[o]=r.data(o.toLowerCase())}}}var u=this,a=e(this);r.settings=e.extend({},t,n);i=r.find(".wizard-act");s=r.find(".wizard-step");r.createStepBar();r._hideAll();i.each(function(){e(this).on("click",null,function(t){if(e(this).is('[data-action="next"]')){r._next.call(u,e(this));return}else if(e(this).is('[data-action="prev"]')){r._prev.call(u,e(this));return}else if(e(this).is('[data-action="finish"]')){r._finish.call(u,e(this));return}else if(e(this).is('[data-action="start"]')){r._start.call(u,e(this));return}else{r._other.call(u,e(this));return}})});r._start(u,null);a.css("display","");r.settings.onInit()};r.createStepBar=function(){if(r.settings.stepBar.visible){o=r.find(".wizard-step-bar");var t=1;var n=s.length;s.each(function(){if(e(this).attr("data-stepbar")!="false"){var i=false;if(t<n){i=true}r.createStepBarLink(e(this).attr("data-step"),t,i);t++}})}};r.createStepBarLink=function(t,n,i){if(r.settings.stepBar.visible){o=r.find(".wizard-step-bar");if(o){var u=s.filter(e('[data-step="'+t+'"]'));if(u){var a=e(e(u)).attr("data-step-bar-title");if(!a){a=n}var f=document.createElement(r.settings.stepBar.objectType);e(f).addClass(r.settings.stepBar.buttonClass);e(f).addClass("wizard-step-bar-button");var l=e(u).attr("data-step");if(r.settings.stepBar.useAnchor){var c=e(document.createElement("a"));e(c).attr("href","#");e(c).attr("data-target",l);e(c).html(a);e(f).append(c)}else{e(f).html(a)}if(r.settings.stepBar.useDivider){if(i){var h=e(document.createElement(r.settings.stepBar.divider));e(h).addClass("divider");e(h).addClass(r.settings.stepBar.dividerClass);e(h).html(r.settings.stepBar.dividerText);e(f).append(h)}}e(f).on("click",function(){var t=e(this).attr("data-target");r.jumpToStep(t,"other");r.updateStepBar(t)});if(l){e(f).attr("data-target",l)}o.append(f)}}}};r.updateStepBar=function(t){if(o){e(o).find(r.settings.stepBar.objectType).each(function(){e(this).removeClass("active");if(e(this).attr("data-target")==t){e(this).addClass("active")}})}};r.jumpToStep=function(t,n){var o=s.filter('[data-step="'+t+'"]');r._hideAll();i.filter("[data-show-on]").each(function(){var n=e(this).attr("data-action");var i=t==e(this).attr("data-show-on");if(n){r.displayAction(n,i)}else{e(this).css("display",i?"":"none")}});i.filter("[data-hide-on]").each(function(){var n=e(this).attr("data-action");var i=!(t==e(this).attr("data-hide-on"));if(n){r.displayAction(n,i)}else{e(this).css("display",i?"":"none")}});o.addClass("active");if(n){if(n=="next"||n=="finish"){e(o).slideLeftShow()}else if(n=="prev"||n=="start"){e(o).slideRightShow()}else if(n=="other"){e(o).slideUpShow()}else{o.fadeIn()}}else{o.fadeIn()}r.enableActions.call();if(e(o).is(s.first())){r.disableAction("start")}if(e(o).is(s.last())){if(r.settings.disableOnFinish){r.disableAction("finish")}}if(!e(o).attr("data-step-next")){r.disableAction("next")}if(!e(o).attr("data-step-prev")){r.disableAction("prev")}i.filter("[data-disable-until]").each(function(){r.disableAction(e(this).attr("data-action"));var n=e(this).attr("data-disable-until");if(e(o).is(s.filter('[data-step="'+n+'"]'))){r.enableAction(e(this).attr("data-action"),t==n)}});var u=e(o).attr("data-action");var a=i.filter('[data-action="'+u+'"]');r.updateStepBar(t);var f=e(a).attr("data-stepbar-step");if(f){r.updateStepBar(f)}r.settings.onStep({stepName:t,actionName:u,action:a,step:o,wiz:this});e(this).trigger("obelisk.wizard.show",{stepName:t,actionName:u,action:a,step:o,wiz:this});return o};r.updateStep=function(e,t,n){s.filter('[data-step="'+e+'"]').attr(t,n)};r.displayAction=function(e,t,n){if(t==undefined){t=false}if(n==undefined){n=false}var r=i.filter('[data-action="'+e+'"]');if(r){r.css("display",t==true?"":"none")}if(n){r.parent("*").css("display",t==true?"":"none")}};r.disableActions=function(){i.each(function(){e(this).attr("disabled","disabled")})};r.enableActions=function(){i.each(function(){e(this).removeAttr("disabled")})};r.disableAction=function(e){i.filter('[data-action="'+e+'"]').attr("disabled","disabled")};r.enableAction=function(e){i.filter('[data-action="'+e+'"]').removeAttr("disabled")};r.jumpToAction=function(t){e(i.filter('[data-action="'+t+'"]')).trigger("click")};r._start=function(t){var n=e(t).attr("data-target");if(n==undefined){n=e(s).first().attr("data-step")}r._show(n,"start",t,r.settings.onStart)};r._next=function(t){r._show(e(s.filter(".active")).attr("data-step-next"),"next",t,r.settings.onNext)};r._prev=function(t){r._show(e(s.filter(".active")).attr("data-step-prev"),"prev",t,r.settings.onPrev)};r._other=function(t){var n=e(t).attr("data-target"),i;if(!n){i=true;n=e(s.filter(".active")).attr("data-step")}r._show(n,e(t).attr("data-action"),t,r.settings.onOther,i);r._trigger("obelisk.wizard.other",t,e(t).attr("data-target"))};r._finish=function(t){var n=e(t).attr("data-target");if(n==undefined){n=e(s).last().attr("data-step")}r._show(n,"finish",t,r.settings.onFinish)};r._hideAll=function(){s.each(function(){e(this).hide();e(this).removeClass("active")})};r._trigger=function(t,n,r){e(this).trigger(t,{action:n,target:r,wiz:this})};r._show=function(e,t,n,i,o){var u=s.filter('[data-step="'+e+'"]');var a=r.settings.onBeforeStep({stepName:e,actionName:t,action:n,step:u});if(a!=undefined&&!a){return}if(o==undefined||!o){r.jumpToStep(e,t)}if(i){i({stepName:e,actionName:t,action:n,step:u,wiz:this})}};u();return r}})(jQuery)
